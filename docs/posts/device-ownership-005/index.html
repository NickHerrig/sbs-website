<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Andrew Dailey">
    <meta name="description" content="Simple software that babbles loudly">
    <meta name="keywords" content="blog,developer,personal">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Device Ownership 005: Longan Nano - Programming the Device"/>
<meta name="twitter:description" content="Programming the device We now have all the information we need to download our smallest.bin program on the device. Remember from before that dfu-util shows us two alternative settings for upgrading firmware. Since we want to program the chip&rsquo;s internal flash, we will need to specify the correct &ldquo;alt&rdquo; identifier (which is 0 in this case). Lastly, we need to specify the &ldquo;range&rdquo; of the Longan Nano&rsquo;s flash storage: where it begins in memory and how large it is."/>

    <meta property="og:title" content="Device Ownership 005: Longan Nano - Programming the Device" />
<meta property="og:description" content="Programming the device We now have all the information we need to download our smallest.bin program on the device. Remember from before that dfu-util shows us two alternative settings for upgrading firmware. Since we want to program the chip&rsquo;s internal flash, we will need to specify the correct &ldquo;alt&rdquo; identifier (which is 0 in this case). Lastly, we need to specify the &ldquo;range&rdquo; of the Longan Nano&rsquo;s flash storage: where it begins in memory and how large it is." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://shallowbrooksoftware.com/posts/device-ownership-005/" />
<meta property="article:published_time" content="2020-02-26T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-02-26T00:00:00+00:00" />


    
      <base href="https://shallowbrooksoftware.com/posts/device-ownership-005/">
    
    <title>
  Device Ownership 005: Longan Nano - Programming the Device · Shallow Brook Software
</title>

    
      <link rel="canonical" href="https://shallowbrooksoftware.com/posts/device-ownership-005/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="/css/coder.min.a4f332213a21ce8eb521670c614470c58923aaaf385e2a73982c31dd7642decb.css" integrity="sha256-pPMyITohzo61IWcMYURwxYkjqq84XipzmCwx3XZC3ss=" crossorigin="anonymous" media="screen" />
    

    

    

    

    

    

    <link rel="icon" type="image/png" href="https://shallowbrooksoftware.com/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://shallowbrooksoftware.com/images/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.59.1" />
  </head>

  
  
  <body class="colorscheme-light">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">
      Shallow Brook Software
    </a>
    
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://shallowbrooksoftware.com/about/">About</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://shallowbrooksoftware.com/posts/">Blog</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://shallowbrooksoftware.com/projects/">Projects</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://shallowbrooksoftware.com/contact/">Contact</a>
          </li>
        
      
      
    </ul>
    
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">Device Ownership 005: Longan Nano - Programming the Device</h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fas fa-calendar"></i>
              <time datetime='2020-02-26T00:00:00Z'>
                February 26, 2020
              </time>
            </span>
          </div>
          
          <div class="tags">
  <i class="fas fa-tag"></i>
    <a href="/tags/risc-v/">risc-v</a>
      <span class="separator">•</span>
    <a href="/tags/firmware/">firmware</a>
      <span class="separator">•</span>
    <a href="/tags/device-ownership/">device ownership</a>
      <span class="separator">•</span>
    <a href="/tags/longan-nano/">longan nano</a></div>

        </div>
      </header>

      <div>
        
        

<h1 id="programming-the-device">Programming the device</h1>

<p>We now have all the information we need to download our <code>smallest.bin</code> program on the device.
Remember from before that dfu-util shows us two alternative settings for upgrading firmware.
Since we want to program the chip&rsquo;s internal flash, we will need to specify the correct &ldquo;alt&rdquo; identifier (which is 0 in this case).
Lastly, we need to specify the &ldquo;range&rdquo; of the Longan Nano&rsquo;s flash storage: where it begins in memory and how large it is.
We know that it starts at address 0x08000000 and is 128 kilobytes in size.
Converting this size to bytes gives us 131072 bytes.
In hexadecimal, this number is represented as 0x20000.</p>

<p>Putting everything together in a way that dfu-util understands yields the following command.</p>

<pre><code>dfu-util --download smallest.bin --alt 0 --dfuse-address 0x08000000:0x20000
</code></pre>

<p>To take the Longan Nano out of DFU mode and back to normal, simply press the RESET button.
Get ready for the excitement!
Just kidding.
This program won&rsquo;t do anything.
Nothing will light up, nothing will flash, nothing will beep.
Do not discredit this achievement, though!</p>

<h1 id="all-that-work-for-nothing">All that work for nothing?!</h1>

<p>Who knew that doing absolutely nothing could be so much work?
Most of what we covered wasn&rsquo;t even related to RISC-V or the code: it was just setup work and preparation.
Don&rsquo;t let that worry you, though.
Almost all of the explanations in this post (DFU mode, udev rules, using dfu-util) won&rsquo;t have to be covered again.</p>

<p>In the next post we will do something slight more flashy: turning on an LED!
Moving forward from there, the future is even brighter.
We will look into using the device&rsquo;s timers to flash LEDs on and off.
We will even get into using that big LCD screen on the front.
Stay tuned from some real action!</p>

      </div>


      <footer>
        


        
        
        
      </footer>
    </article>

    
  </section>

      </div>

      <footer class="footer">
  <section class="container">
    
      <p>simple software that babbles loudly</p>
    
    
      
        © 2020
      
       Andrew Dailey 
    
    
       · 
       <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
    
    
  </section>
</footer>

    </main>

    

    

  </body>

</html>
